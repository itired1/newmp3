<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>itired üéµ - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #141414;
            --bg-card: #1a1a1a;
            --bg-hover: #222222;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --text-muted: #666666;
            --accent-primary: #ff6b6b;
            --accent-secondary: #667eea;
            --accent-success: #51cf66;
            --accent-warning: #ffd43b;
            --accent-danger: #ff6b6b;
            --border-color: #333333;
            --glass-border: rgba(255, 255, 255, 0.1);
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 8px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.5);
            --border-radius-sm: 8px;
            --border-radius: 12px;
            --border-radius-lg: 16px;
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .admin-container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .admin-sidebar {
            width: 280px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            padding: 2rem 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
        }

        .admin-logo {
            padding: 0 2rem 2rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 2rem;
        }

        .admin-logo h2 {
            font-size: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .admin-logo i {
            color: var(--accent-primary);
            font-size: 1.8rem;
        }

        .admin-nav {
            padding: 0 1.5rem;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--border-radius-sm);
            margin-bottom: 0.5rem;
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-item i {
            width: 20px;
            text-align: center;
        }

        .nav-item:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--accent-primary);
            color: white;
        }

        .admin-footer {
            margin-top: auto;
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
        }

        /* Main content */
        .admin-content {
            flex: 1;
            margin-left: 280px;
            padding: 2rem;
            min-height: 100vh;
        }

        .section {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        h1 i {
            color: var(--accent-primary);
        }

        /* Stats grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .stat-card:hover {
            border-color: var(--accent-primary);
            transform: translateY(-2px);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .stat-card:nth-child(1) .stat-icon { background: linear-gradient(135deg, #667eea, #764ba2); }
        .stat-card:nth-child(2) .stat-icon { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .stat-card:nth-child(3) .stat-icon { background: linear-gradient(135deg, #4facfe, #00f2fe); }
        .stat-card:nth-child(4) .stat-icon { background: linear-gradient(135deg, #43e97b, #38f9d7); }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin: 0.5rem 0;
        }

        .stat-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Tables */
        .table-container {
            background: var(--bg-card);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-color);
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }

        .admin-table th {
            background: var(--bg-secondary);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .admin-table td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .admin-table tr:last-child td {
            border-bottom: none;
        }

        .admin-table tr:hover {
            background: var(--bg-hover);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border-radius: var(--border-radius-sm);
            border: none;
            font-family: inherit;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
        }

        .btn-primary {
            background: var(--accent-primary);
            color: white;
        }

        .btn-primary:hover {
            background: #ff5252;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .btn-success {
            background: var(--accent-success);
            color: white;
        }

        .btn-danger {
            background: var(--accent-danger);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        .btn-group {
            display: flex;
            gap: 0.5rem;
        }

        /* Forms */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
            font-family: inherit;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            border: 1px solid var(--border-color);
            margin-bottom: 1.5rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* Upload */
        .upload-area {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .upload-area:hover {
            border-color: var(--accent-primary);
            background: var(--bg-hover);
        }

        .upload-area i {
            font-size: 3rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .upload-area h3 {
            margin-bottom: 0.5rem;
        }

        .upload-area p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 2rem;
        }

        .page-link {
            padding: 0.5rem 1rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-sm);
            color: var(--text-primary);
            text-decoration: none;
            transition: var(--transition);
        }

        .page-link:hover {
            background: var(--bg-hover);
        }

        .page-link.active {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        /* Alerts */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius-sm);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .alert-success {
            background: rgba(81, 207, 102, 0.1);
            border: 1px solid rgba(81, 207, 102, 0.3);
            color: var(--accent-success);
        }

        .alert-error {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.3);
            color: var(--accent-danger);
        }

        .alert-warning {
            background: rgba(255, 212, 59, 0.1);
            border: 1px solid rgba(255, 212, 59, 0.3);
            color: var(--accent-warning);
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-success {
            background: rgba(81, 207, 102, 0.2);
            color: var(--accent-success);
        }

        .badge-warning {
            background: rgba(255, 212, 59, 0.2);
            color: var(--accent-warning);
        }

        .badge-danger {
            background: rgba(255, 107, 107, 0.2);
            color: var(--accent-danger);
        }

        .badge-info {
            background: rgba(102, 126, 234, 0.2);
            color: var(--accent-secondary);
        }

        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border-color);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .admin-sidebar {
                width: 250px;
            }
            
            .admin-content {
                margin-left: 250px;
            }
        }

        @media (max-width: 768px) {
            .admin-container {
                flex-direction: column;
            }
            
            .admin-sidebar {
                position: relative;
                width: 100%;
                height: auto;
                padding: 1rem 0;
            }
            
            .admin-content {
                margin-left: 0;
                padding: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="admin-sidebar">
            <div class="admin-logo">
                <h2><i class="fas fa-crown"></i> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h2>
            </div>
            
            <nav class="admin-nav">
                <a href="#" class="nav-item active" data-section="stats">
                    <i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
                </a>
                <a href="#" class="nav-item" data-section="users">
                    <i class="fas fa-users"></i> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
                </a>
                <a href="#" class="nav-item" data-section="shop">
                    <i class="fas fa-store"></i> –ú–∞–≥–∞–∑–∏–Ω
                </a>
                <a href="#" class="nav-item" data-section="banners">
                    <i class="fas fa-image"></i> –ë–∞–Ω–Ω–µ—Ä—ã
                </a>
                <a href="#" class="nav-item" data-section="bot">
                    <i class="fab fa-telegram"></i> Telegram –±–æ—Ç
                </a>
                <a href="#" class="nav-item" data-section="upload">
                    <i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
                </a>
                <a href="#" class="nav-item" data-section="system">
                    <i class="fas fa-cog"></i> –°–∏—Å—Ç–µ–º–∞
                </a>
            </nav>
            
            <div class="admin-footer">
                <a href="/" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> –ù–∞ —Å–∞–π—Ç
                </a>
            </div>
        </div>
        
        <!-- Main content -->
        <div class="admin-content">
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="section active" id="stats-section">
                <h1><i class="fas fa-chart-bar"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h1>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                            <div class="stat-value" id="stat-users">0</div>
                            <div class="stat-desc">–í—Å–µ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-store"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–¢–æ–≤–∞—Ä—ã</h3>
                            <div class="stat-value" id="stat-items">0</div>
                            <div class="stat-desc">–í –º–∞–≥–∞–∑–∏–Ω–µ</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–ü—Ä–æ–¥–∞–∂–∏</h3>
                            <div class="stat-value" id="stat-sales">0</div>
                            <div class="stat-desc">–í—Å–µ–≥–æ –ø—Ä–æ–¥–∞–∂</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–í–∞–ª—é—Ç–∞</h3>
                            <div class="stat-value" id="stat-currency">0</div>
                            <div class="stat-desc">–í –æ–±—Ä–∞—â–µ–Ω–∏–∏</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å API (24—á)</h3>
                        <div class="btn-group">
                            <button class="btn btn-sm btn-secondary" data-period="hour">–ß–∞—Å</button>
                            <button class="btn btn-sm btn-secondary active" data-period="day">–î–µ–Ω—å</button>
                            <button class="btn btn-sm btn-secondary" data-period="week">–ù–µ–¥–µ–ª—è</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="admin-table" id="api-stats-table">
                            <thead>
                                <tr>
                                    <th>–≠–Ω–¥–ø–æ–∏–Ω—Ç</th>
                                    <th>–ó–∞–ø—Ä–æ—Å—ã</th>
                                    <th>–°—Ä. –≤—Ä–µ–º—è</th>
                                    <th>–û—à–∏–±–∫–∏</th>
                                </tr>
                            </thead>
                            <tbody id="api-stats-body">
                                <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ -->
            <div class="section" id="users-section">
                <h1><i class="fas fa-users"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h1>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                        <div class="btn-group">
                            <input type="text" class="form-control" id="user-search" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π..." style="width: 300px;">
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ò–º—è</th>
                                    <th>Email</th>
                                    <th>Telegram</th>
                                    <th>–ë–∞–ª–∞–Ω—Å</th>
                                    <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="users-table-body">
                                <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                        </table>
                    </div>
                    <div class="pagination" id="users-pagination"></div>
                </div>
                
                <div class="card" id="user-edit-card" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                        <button class="btn btn-secondary" id="close-edit">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                    <div class="card-body">
                        <form id="edit-user-form">
                            <input type="hidden" id="edit-user-id">
                            <div class="form-group">
                                <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                                <input type="text" id="edit-username" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Email</label>
                                <input type="email" id="edit-email" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è</label>
                                <input type="text" id="edit-display-name" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">–ë–∞–ª–∞–Ω—Å –º–æ–Ω–µ—Ç</label>
                                <input type="number" id="edit-balance" class="form-control" min="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Telegram ID</label>
                                <input type="text" id="edit-telegram-id" class="form-control">
                            </div>
                            <div class="form-group">
                                <label class="form-label">–†–æ–ª—å</label>
                                <select id="edit-role" class="form-control">
                                    <option value="user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</option>
                                    <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                                <button type="button" class="btn btn-danger" id="delete-user">–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º -->
            <div class="section" id="shop-section">
                <h1><i class="fas fa-store"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º</h1>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–¢–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞</h3>
                        <div class="btn-group">
                            <button class="btn btn-primary" id="add-item-btn">
                                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                    <th>–¶–µ–Ω–∞</th>
                                    <th>–†–µ–¥–∫–æ—Å—Ç—å</th>
                                    <th>–ü—Ä–æ–¥–∞–∂–∏</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="shop-items-body">
                                <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ -->
                <div class="card" id="item-form-card" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title" id="item-form-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
                        <button class="btn btn-secondary" id="close-item-form">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                    <div class="card-body">
                        <form id="item-form">
                            <input type="hidden" id="item-id">
                            
                            <div class="form-group">
                                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *</label>
                                <input type="text" id="item-name" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                <textarea id="item-description" class="form-control" rows="3"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–¢–∏–ø —Ç–æ–≤–∞—Ä–∞ *</label>
                                <select id="item-type" class="form-control" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                                    <option value="theme">–¢–µ–º–∞</option>
                                    <option value="avatar">–ê–≤–∞—Ç–∞—Ä</option>
                                    <option value="profile_banner">–ë–∞–Ω–Ω–µ—Ä –ø—Ä–æ—Ñ–∏–ª—è</option>
                                    <option value="badge">–ë–µ–π–¥–∂</option>
                                    <option value="effect">–≠—Ñ—Ñ–µ–∫—Ç</option>
                                    <option value="animation">–ê–Ω–∏–º–∞—Ü–∏—è</option>
                                    <option value="music">–ú—É–∑—ã–∫–∞</option>
                                    <option value="sticker">–°—Ç–∏–∫–µ—Ä</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                                <select id="item-category" class="form-control" required>
                                    <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–¶–µ–Ω–∞ (–º–æ–Ω–µ—Ç—ã) *</label>
                                <input type="number" id="item-price" class="form-control" min="0" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–†–µ–¥–∫–æ—Å—Ç—å</label>
                                <select id="item-rarity" class="form-control">
                                    <option value="common">–û–±—ã—á–Ω—ã–π</option>
                                    <option value="rare">–†–µ–¥–∫–∏–π</option>
                                    <option value="epic">–≠–ø–∏—á–µ—Å–∫–∏–π</option>
                                    <option value="legendary">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</option>
                                    <option value="mythic">–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ (-1 = –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ)</label>
                                <input type="number" id="item-stock" class="form-control" value="-1" min="-1">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                                <input type="text" id="item-image-url" class="form-control" placeholder="https://example.com/image.jpg">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ (JSON)</label>
                                <textarea id="item-data" class="form-control" rows="6" placeholder='{"key": "value"}'></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                                <div>
                                    <input type="checkbox" id="item-active" checked> –ê–∫—Ç–∏–≤–µ–Ω
                                    <input type="checkbox" id="item-featured" style="margin-left: 20px;"> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π
                                    <input type="checkbox" id="item-new" style="margin-left: 20px;"> –ù–æ–≤–∏–Ω–∫–∞
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary" id="save-item-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                                <button type="button" class="btn btn-danger" id="delete-item-btn" style="display: none;">–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞–º–∏ -->
            <div class="section" id="banners-section">
                <h1><i class="fas fa-image"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞–º–∏</h1>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–ë–∞–Ω–Ω–µ—Ä—ã</h3>
                        <div class="btn-group">
                            <button class="btn btn-primary" id="add-banner-btn">
                                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –±–∞–Ω–Ω–µ—Ä
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                    <th>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
                                    <th>–¶–µ–Ω–∞</th>
                                    <th>–†–µ–¥–∫–æ—Å—Ç—å</th>
                                    <th>–°—Ç–∞—Ç—É—Å</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="banners-body">
                                <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- –§–æ—Ä–º–∞ –±–∞–Ω–Ω–µ—Ä–∞ -->
                <div class="card" id="banner-form-card" style="display: none;">
                    <div class="card-header">
                        <h3 class="card-title" id="banner-form-title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞</h3>
                        <button class="btn btn-secondary" id="close-banner-form">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                    <div class="card-body">
                        <form id="banner-form">
                            <input type="hidden" id="banner-id">
                            
                            <div class="form-group">
                                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞ *</label>
                                <input type="text" id="banner-name" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                <textarea id="banner-description" class="form-control" rows="3"></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è *</label>
                                <input type="text" id="banner-image-url" class="form-control" required placeholder="https://example.com/banner.jpg">
                                <small class="text-muted">–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º—É—é —Å—Å—ã–ª–∫—É –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –Ω–∏–∂–µ</small>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">URL –ø—Ä–µ–≤—å—é</label>
                                <input type="text" id="banner-preview-url" class="form-control" placeholder="https://example.com/preview.jpg">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–¶–µ–Ω–∞ (–º–æ–Ω–µ—Ç—ã)</label>
                                <input type="number" id="banner-price" class="form-control" min="0" value="0">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–†–µ–¥–∫–æ—Å—Ç—å</label>
                                <select id="banner-rarity" class="form-control">
                                    <option value="common">–û–±—ã—á–Ω—ã–π</option>
                                    <option value="rare">–†–µ–¥–∫–∏–π</option>
                                    <option value="epic">–≠–ø–∏—á–µ—Å–∫–∏–π</option>
                                    <option value="legendary">–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                                <input type="text" id="banner-category" class="form-control" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –∞–Ω–∏–º–µ, –ø—Ä–∏—Ä–æ–¥–∞, –∫–æ—Å–º–æ—Å">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–¢–µ–≥–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                                <input type="text" id="banner-tags" class="form-control" placeholder="—Ç–µ–≥1, —Ç–µ–≥2, —Ç–µ–≥3">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–°—Ç–∞—Ç—É—Å</label>
                                <div>
                                    <input type="checkbox" id="banner-active" checked> –ê–∫—Ç–∏–≤–µ–Ω
                                    <input type="checkbox" id="banner-featured" style="margin-left: 20px;"> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary" id="save-banner-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –±–∞–Ω–Ω–µ—Ä</button>
                                <button type="button" class="btn btn-danger" id="delete-banner-btn" style="display: none;">–£–¥–∞–ª–∏—Ç—å –±–∞–Ω–Ω–µ—Ä</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Telegram –±–æ—Ç–æ–º -->
            <div class="section" id="bot-section">
                <h1><i class="fab fa-telegram"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Telegram –±–æ—Ç–æ–º</h1>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fab fa-telegram"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–°—Ç–∞—Ç—É—Å –±–æ—Ç–∞</h3>
                            <div class="stat-value" id="bot-status">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                            <div class="stat-desc" id="bot-details"></div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                            <div class="stat-value" id="bot-users">0</div>
                            <div class="stat-desc">–° –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–º Telegram</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–ê–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–¥—ã</h3>
                            <div class="stat-value" id="active-codes">0</div>
                            <div class="stat-desc">–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏/–ø—Ä–∏–≤—è–∑–∫–∏</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                            <div class="stat-value" id="notifications-sent">0</div>
                            <div class="stat-desc">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∑–∞ —Å–µ–≥–æ–¥–Ω—è</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <label class="form-label">–¢–æ–∫–µ–Ω –±–æ—Ç–∞</label>
                            <input type="text" id="bot-token" class="form-control" value="********" disabled>
                            <small class="text-muted">–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</small>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">URL —Å–µ—Ä–≤–µ—Ä–∞</label>
                            <input type="text" id="server-url" class="form-control" value="http://localhost:5001">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞</label>
                            <select id="bot-auto-start" class="form-control">
                                <option value="true">–í–∫–ª—é—á–µ–Ω</option>
                                <option value="false">–û—Ç–∫–ª—é—á–µ–Ω</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <button class="btn btn-primary" id="restart-bot-btn">
                                <i class="fas fa-sync-alt"></i> –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
                            </button>
                            <button class="btn btn-secondary" id="test-bot-btn">
                                <i class="fas fa-vial"></i> –¢–µ—Å—Ç –±–æ—Ç–∞
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è</h3>
                    </div>
                    <div class="card-body">
                        <form id="test-message-form">
                            <div class="form-group">
                                <label class="form-label">Telegram ID –ø–æ–ª—É—á–∞—Ç–µ–ª—è</label>
                                <input type="text" id="test-telegram-id" class="form-control" required>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
                                <textarea id="test-message" class="form-control" rows="4" required placeholder="–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ -->
            <div class="section" id="upload-section">
                <h1><i class="fas fa-upload"></i> –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤</h1>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞</h3>
                    </div>
                    <div class="card-body">
                        <div class="upload-area" id="upload-area">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª—ã —Å—é–¥–∞</h3>
                            <p>–∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤</p>
                            <p class="text-muted">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: PNG, JPG, GIF, WEBP, SVG, MP3, WAV, OGG, MP4</p>
                            <p class="text-muted">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 16MB</p>
                            <input type="file" id="file-input" style="display: none;" accept=".png,.jpg,.jpeg,.gif,.webp,.svg,.mp3,.wav,.ogg,.mp4">
                        </div>
                        
                        <div class="form-group" style="margin-top: 2rem;">
                            <label class="form-label">–¢–∏–ø —Ñ–∞–π–ª–∞</label>
                            <select id="upload-type" class="form-control">
                                <option value="avatar">–ê–≤–∞—Ç–∞—Ä</option>
                                <option value="banner">–ë–∞–Ω–Ω–µ—Ä</option>
                                <option value="shop_item">–¢–æ–≤–∞—Ä –º–∞–≥–∞–∑–∏–Ω–∞</option>
                                <option value="music_cover">–û–±–ª–æ–∂–∫–∞ –º—É–∑—ã–∫–∏</option>
                                <option value="other">–î—Ä—É–≥–æ–µ</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                            <input type="text" id="upload-filename" class="form-control" placeholder="–ú–æ–π —Ñ–∞–π–ª.jpg">
                        </div>
                        
                        <div class="form-group">
                            <button class="btn btn-primary" id="upload-btn" disabled>
                                <i class="fas fa-upload"></i> –ù–∞—á–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
                            </button>
                            <div class="progress" style="margin-top: 1rem; display: none;" id="upload-progress">
                                <div class="progress-bar" style="width: 0%; height: 20px; background: var(--accent-primary); border-radius: 4px;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–ù–µ–¥–∞–≤–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</h3>
                    </div>
                    <div class="table-container">
                        <table class="admin-table">
                            <thead>
                                <tr>
                                    <th>–ò–º—è —Ñ–∞–π–ª–∞</th>
                                    <th>–¢–∏–ø</th>
                                    <th>–†–∞–∑–º–µ—Ä</th>
                                    <th>URL</th>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="uploaded-files-body">
                                <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- –°–∏—Å—Ç–µ–º–∞ -->
            <div class="section" id="system-section">
                <h1><i class="fas fa-cog"></i> –°–∏—Å—Ç–µ–º–∞</h1>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
                            <div class="stat-value" id="db-status">–û–Ω–ª–∞–π–Ω</div>
                            <div class="stat-desc">SQLite</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Redis</h3>
                            <div class="stat-value" id="redis-status">–û—Ñ–ª–∞–π–Ω</div>
                            <div class="stat-desc">–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-server"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–ü–∞–º—è—Ç—å</h3>
                            <div class="stat-value" id="memory-usage">0%</div>
                            <div class="stat-desc">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã</h3>
                            <div class="stat-value" id="uptime">0—á</div>
                            <div class="stat-desc">–°–µ—Ä–≤–µ—Ä–∞</div>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–û—á–∏—Å—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <button class="btn btn-warning" id="clear-cache-btn">
                                <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
                            </button>
                            <small class="text-muted" style="margin-left: 1rem;">–£–¥–∞–ª—è–µ—Ç –≤—Å–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</small>
                        </div>
                        
                        <div class="form-group">
                            <button class="btn btn-warning" id="clear-old-codes-btn">
                                <i class="fas fa-hourglass-end"></i> –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–¥—ã
                            </button>
                            <small class="text-muted" style="margin-left: 1rem;">–£–¥–∞–ª—è–µ—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∫–æ–¥—ã Telegram</small>
                        </div>
                        
                        <div class="form-group">
                            <button class="btn btn-danger" id="reset-shop-btn">
                                <i class="fas fa-store-slash"></i> –°–±—Ä–æ—Å–∏—Ç—å –º–∞–≥–∞–∑–∏–Ω
                            </button>
                            <small class="text-muted" style="margin-left: 1rem;">–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã</small>
                        </div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">–õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-group">
                            <textarea class="form-control" id="system-logs" rows="10" readonly style="font-family: monospace; font-size: 12px;"></textarea>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-secondary" id="refresh-logs-btn">
                                <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏
                            </button>
                            <button class="btn btn-secondary" id="clear-logs-btn">
                                <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Loading overlay -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="spinner"></div>
    </div>
    
    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentPage = 1;
        let itemsPerPage = 20;
        let currentSection = 'stats';
        let selectedFile = null;
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const loadingOverlay = document.getElementById('loading-overlay');
        const navItems = document.querySelectorAll('.nav-item');
        const sections = document.querySelectorAll('.section');
        
        // –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å loading
        function showLoading() {
            loadingOverlay.style.display = 'flex';
        }
        
        function hideLoading() {
            loadingOverlay.style.display = 'none';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function showMessage(message, type = 'success') {
            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i>
                <span>${message}</span>
            `;
            
            document.querySelector('.admin-content').insertBefore(alert, document.querySelector('.section.active h1').nextSibling);
            
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π
        navItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                
                const section = item.dataset.section;
                if (currentSection === section) return;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
                navItems.forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');
                
                // –°–∫—Ä—ã–≤–∞–µ–º —Ç–µ–∫—É—â—É—é —Å–µ–∫—Ü–∏—é
                sections.forEach(sec => {
                    sec.classList.remove('active');
                    if (sec.id === `${section}-section`) {
                        sec.classList.add('active');
                        currentSection = section;
                    }
                });
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–æ–≤–æ–π —Å–µ–∫—Ü–∏–∏
                loadSectionData(section);
            });
        });
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ–∫—Ü–∏–∏
        async function loadSectionData(section) {
            showLoading();
            
            try {
                switch(section) {
                    case 'stats':
                        await loadStats();
                        break;
                    case 'users':
                        await loadUsers();
                        break;
                    case 'shop':
                        await loadShopItems();
                        await loadCategories();
                        break;
                    case 'banners':
                        await loadBanners();
                        break;
                    case 'bot':
                        await loadBotStatus();
                        break;
                    case 'upload':
                        await loadUploadedFiles();
                        break;
                    case 'system':
                        await loadSystemInfo();
                        break;
                }
            } catch (error) {
                console.error('Error loading section data:', error);
                showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
            } finally {
                hideLoading();
            }
        }
        
        // === –°–¢–ê–¢–ò–°–¢–ò–ö–ê ===
        async function loadStats() {
            try {
                const response = await fetch('/api/admin/stats');
                const data = await response.json();
                
                if (response.ok) {
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    document.getElementById('stat-users').textContent = data.users.total;
                    document.getElementById('stat-items').textContent = data.shop.total_items;
                    document.getElementById('stat-sales').textContent = data.shop.total_sales;
                    document.getElementById('stat-currency').textContent = data.currency.total_in_circulation;
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É API
                    await loadApiStats('day');
                }
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }
        
        async function loadApiStats(period) {
            try {
                const response = await fetch(`/api/admin/api_stats?period=${period}`);
                const data = await response.json();
                
                if (response.ok) {
                    const tbody = document.getElementById('api-stats-body');
                    tbody.innerHTML = '';
                    
                    data.forEach(stat => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${stat.endpoint}</td>
                            <td>${stat.count}</td>
                            <td>${stat.avg_time.toFixed(2)}ms</td>
                            <td><span class="badge ${stat.errors > 0 ? 'badge-danger' : 'badge-success'}">${stat.errors}</span></td>
                        `;
                        tbody.appendChild(row);
                    });
                }
            } catch (error) {
                console.error('Error loading API stats:', error);
            }
        }
        
        // === –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò ===
        async function loadUsers(page = 1) {
            try {
                const response = await fetch(`/api/admin/users?page=${page}&per_page=${itemsPerPage}`);
                const data = await response.json();
                
                if (response.ok) {
                    const tbody = document.getElementById('users-table-body');
                    tbody.innerHTML = '';
                    
                    data.users.forEach(user => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${user.id}</td>
                            <td>
                                <strong>${user.username}</strong>
                                ${user.is_admin ? '<span class="badge badge-danger" style="margin-left: 5px;">ADMIN</span>' : ''}
                            </td>
                            <td>${user.email}</td>
                            <td>${user.telegram_linked ? '‚úÖ' : '‚ùå'}</td>
                            <td>${user.balance}</td>
                            <td>${new Date(user.created_at).toLocaleDateString()}</td>
                            <td>
                                <button class="btn btn-sm btn-secondary edit-user" data-id="${user.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger delete-user" data-id="${user.id}" ${user.is_admin ? 'disabled' : ''}>
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
                    updatePagination('users-pagination', data.pages, page);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                    addUserEventListeners();
                }
            } catch (error) {
                console.error('Error loading users:', error);
            }
        }
        
        function addUserEventListeners() {
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.querySelectorAll('.edit-user').forEach(btn => {
                btn.addEventListener('click', () => editUser(btn.dataset.id));
            });
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.querySelectorAll('.delete-user').forEach(btn => {
                btn.addEventListener('click', () => deleteUser(btn.dataset.id));
            });
            
            // –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const searchInput = document.getElementById('user-search');
            if (searchInput) {
                searchInput.addEventListener('input', debounce(() => {
                    searchUsers(searchInput.value);
                }, 300));
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            const closeEditBtn = document.getElementById('close-edit');
            if (closeEditBtn) {
                closeEditBtn.addEventListener('click', () => {
                    document.getElementById('user-edit-card').style.display = 'none';
                });
            }
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const editForm = document.getElementById('edit-user-form');
            if (editForm) {
                editForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await saveUserChanges();
                });
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const deleteBtn = document.getElementById('delete-user');
            if (deleteBtn) {
                deleteBtn.addEventListener('click', async () => {
                    const userId = document.getElementById('edit-user-id').value;
                    if (confirm(`–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userId}?`)) {
                        await deleteUser(userId);
                    }
                });
            }
        }
        
        async function editUser(userId) {
            try {
                showLoading();
                const response = await fetch(`/api/admin/users/${userId}`);
                const user = await response.json();
                
                if (response.ok) {
                    document.getElementById('edit-user-id').value = user.id;
                    document.getElementById('edit-username').value = user.username;
                    document.getElementById('edit-email').value = user.email;
                    document.getElementById('edit-display-name').value = user.display_name || '';
                    document.getElementById('edit-balance').value = user.balance;
                    document.getElementById('edit-telegram-id').value = user.telegram_id || '';
                    document.getElementById('edit-role').value = user.is_admin ? 'admin' : 'user';
                    
                    document.getElementById('user-edit-card').style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading user:', error);
                showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function saveUserChanges() {
            const userId = document.getElementById('edit-user-id').value;
            const userData = {
                username: document.getElementById('edit-username').value,
                email: document.getElementById('edit-email').value,
                display_name: document.getElementById('edit-display-name').value,
                balance: parseInt(document.getElementById('edit-balance').value),
                telegram_id: document.getElementById('edit-telegram-id').value,
                is_admin: document.getElementById('edit-role').value === 'admin'
            };
            
            try {
                showLoading();
                const response = await fetch(`/api/admin/users/${userId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(userData)
                });
                
                if (response.ok) {
                    showMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω');
                    loadUsers(currentPage);
                    document.getElementById('user-edit-card').style.display = 'none';
                } else {
                    const error = await response.json();
                    showMessage(error.error || '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error saving user:', error);
                showMessage('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function deleteUser(userId) {
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${userId}?`)) {
                return;
            }
            
            try {
                showLoading();
                const response = await fetch(`/api/admin/users/${userId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω');
                    loadUsers(currentPage);
                    document.getElementById('user-edit-card').style.display = 'none';
                } else {
                    const error = await response.json();
                    showMessage(error.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error deleting user:', error);
                showMessage('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function searchUsers(query) {
            if (!query.trim()) {
                loadUsers();
                return;
            }
            
            try {
                const response = await fetch(`/api/admin/users/search?q=${encodeURIComponent(query)}`);
                const data = await response.json();
                
                if (response.ok) {
                    const tbody = document.getElementById('users-table-body');
                    tbody.innerHTML = '';
                    
                    data.forEach(user => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${user.id}</td>
                            <td>${user.username} ${user.is_admin ? '<span class="badge badge-danger">ADMIN</span>' : ''}</td>
                            <td>${user.email}</td>
                            <td>${user.telegram_linked ? '‚úÖ' : '‚ùå'}</td>
                            <td>${user.balance}</td>
                            <td>${new Date(user.created_at).toLocaleDateString()}</td>
                            <td>
                                <button class="btn btn-sm btn-secondary edit-user" data-id="${user.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger delete-user" data-id="${user.id}" ${user.is_admin ? 'disabled' : ''}>
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                    
                    addUserEventListeners();
                }
            } catch (error) {
                console.error('Error searching users:', error);
            }
        }
        
        // === –ú–ê–ì–ê–ó–ò–ù ===
        async function loadShopItems() {
            try {
                const response = await fetch('/api/admin/shop/items');
                const items = await response.json();
                
                if (response.ok) {
                    const tbody = document.getElementById('shop-items-body');
                    tbody.innerHTML = '';
                    
                    items.forEach(item => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${item.id}</td>
                            <td>${item.name}</td>
                            <td><span class="badge badge-info">${item.type}</span></td>
                            <td>${item.category_name}</td>
                            <td>${item.price}</td>
                            <td><span class="badge ${getRarityClass(item.rarity)}">${item.rarity}</span></td>
                            <td>${item.sales_count}</td>
                            <td>${item.is_active ? '<span class="badge badge-success">–ê–∫—Ç–∏–≤–µ–Ω</span>' : '<span class="badge badge-danger">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>'}</td>
                            <td>
                                <button class="btn btn-sm btn-secondary edit-item" data-id="${item.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger delete-item" data-id="${item.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                    
                    addShopEventListeners();
                }
            } catch (error) {
                console.error('Error loading shop items:', error);
            }
        }
        
        async function loadCategories() {
            try {
                const response = await fetch('/api/admin/shop/categories');
                const categories = await response.json();
                
                if (response.ok) {
                    const select = document.getElementById('item-category');
                    select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>';
                    
                    categories.forEach(cat => {
                        const option = document.createElement('option');
                        option.value = cat.id;
                        option.textContent = cat.name;
                        select.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }
        
        function addShopEventListeners() {
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
            const addBtn = document.getElementById('add-item-btn');
            if (addBtn) {
                addBtn.addEventListener('click', () => {
                    document.getElementById('item-form-title').textContent = '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞';
                    document.getElementById('item-form-card').style.display = 'block';
                    resetItemForm();
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã
            const closeBtn = document.getElementById('close-item-form');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    document.getElementById('item-form-card').style.display = 'none';
                });
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
            document.querySelectorAll('.edit-item').forEach(btn => {
                btn.addEventListener('click', () => editItem(btn.dataset.id));
            });
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
            document.querySelectorAll('.delete-item').forEach(btn => {
                btn.addEventListener('click', () => deleteItem(btn.dataset.id));
            });
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
            const itemForm = document.getElementById('item-form');
            if (itemForm) {
                itemForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await saveItem();
                });
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ —Ñ–æ—Ä–º—ã
            const deleteItemBtn = document.getElementById('delete-item-btn');
            if (deleteItemBtn) {
                deleteItemBtn.addEventListener('click', async () => {
                    const itemId = document.getElementById('item-id').value;
                    if (itemId && confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                        await deleteItem(itemId);
                    }
                });
            }
        }
        
        function resetItemForm() {
            document.getElementById('item-id').value = '';
            document.getElementById('item-name').value = '';
            document.getElementById('item-description').value = '';
            document.getElementById('item-type').value = '';
            document.getElementById('item-price').value = '';
            document.getElementById('item-rarity').value = 'common';
            document.getElementById('item-stock').value = '-1';
            document.getElementById('item-image-url').value = '';
            document.getElementById('item-data').value = '';
            document.getElementById('item-active').checked = true;
            document.getElementById('item-featured').checked = false;
            document.getElementById('item-new').checked = false;
            document.getElementById('delete-item-btn').style.display = 'none';
        }
        
        async function editItem(itemId) {
            try {
                showLoading();
                const response = await fetch(`/api/admin/shop/items/${itemId}`);
                const item = await response.json();
                
                if (response.ok) {
                    document.getElementById('item-form-title').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞';
                    document.getElementById('item-form-card').style.display = 'block';
                    
                    document.getElementById('item-id').value = item.id;
                    document.getElementById('item-name').value = item.name;
                    document.getElementById('item-description').value = item.description || '';
                    document.getElementById('item-type').value = item.type;
                    document.getElementById('item-category').value = item.category_id;
                    document.getElementById('item-price').value = item.price;
                    document.getElementById('item-rarity').value = item.rarity;
                    document.getElementById('item-stock').value = item.stock;
                    document.getElementById('item-image-url').value = item.image_url || '';
                    document.getElementById('item-data').value = JSON.stringify(item.data, null, 2);
                    document.getElementById('item-active').checked = item.is_active;
                    document.getElementById('item-featured').checked = item.is_featured;
                    document.getElementById('item-new').checked = item.is_new;
                    document.getElementById('delete-item-btn').style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading item:', error);
                showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–∞', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function saveItem() {
            const itemId = document.getElementById('item-id').value;
            const itemData = {
                name: document.getElementById('item-name').value,
                description: document.getElementById('item-description').value,
                type: document.getElementById('item-type').value,
                category_id: parseInt(document.getElementById('item-category').value),
                price: parseInt(document.getElementById('item-price').value),
                rarity: document.getElementById('item-rarity').value,
                stock: parseInt(document.getElementById('item-stock').value),
                image_url: document.getElementById('item-image-url').value,
                data: document.getElementById('item-data').value ? JSON.parse(document.getElementById('item-data').value) : {},
                is_active: document.getElementById('item-active').checked,
                is_featured: document.getElementById('item-featured').checked,
                is_new: document.getElementById('item-new').checked
            };
            
            try {
                showLoading();
                const url = itemId ? `/api/admin/shop/items/${itemId}` : '/api/admin/shop/items';
                const method = itemId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(itemData)
                });
                
                if (response.ok) {
                    showMessage(itemId ? '–¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω' : '–¢–æ–≤–∞—Ä —Å–æ–∑–¥–∞–Ω');
                    loadShopItems();
                    document.getElementById('item-form-card').style.display = 'none';
                } else {
                    const error = await response.json();
                    showMessage(error.error || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error saving item:', error);
                showMessage('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function deleteItem(itemId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                return;
            }
            
            try {
                showLoading();
                const response = await fetch(`/api/admin/shop/items/${itemId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showMessage('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω');
                    loadShopItems();
                    document.getElementById('item-form-card').style.display = 'none';
                } else {
                    const error = await response.json();
                    showMessage(error.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error deleting item:', error);
                showMessage('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        // === –ë–ê–ù–ù–ï–†–´ ===
        async function loadBanners() {
            try {
                const response = await fetch('/api/admin/banners');
                const banners = await response.json();
                
                if (response.ok) {
                    const tbody = document.getElementById('banners-body');
                    tbody.innerHTML = '';
                    
                    banners.forEach(banner => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${banner.id}</td>
                            <td>${banner.name}</td>
                            <td><img src="${banner.image_url}" alt="${banner.name}" style="width: 100px; height: 50px; object-fit: cover; border-radius: 4px;"></td>
                            <td>${banner.price}</td>
                            <td><span class="badge ${getRarityClass(banner.rarity)}">${banner.rarity}</span></td>
                            <td>${banner.is_active ? '<span class="badge badge-success">–ê–∫—Ç–∏–≤–µ–Ω</span>' : '<span class="badge badge-danger">–ù–µ–∞–∫—Ç–∏–≤–µ–Ω</span>'}</td>
                            <td>
                                <button class="btn btn-sm btn-secondary edit-banner" data-id="${banner.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger delete-banner" data-id="${banner.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                    
                    addBannerEventListeners();
                }
            } catch (error) {
                console.error('Error loading banners:', error);
            }
        }
        
        function addBannerEventListeners() {
            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞
            const addBtn = document.getElementById('add-banner-btn');
            if (addBtn) {
                addBtn.addEventListener('click', () => {
                    document.getElementById('banner-form-title').textContent = '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞';
                    document.getElementById('banner-form-card').style.display = 'block';
                    resetBannerForm();
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º—ã
            const closeBtn = document.getElementById('close-banner-form');
            if (closeBtn) {
                closeBtn.addEventListener('click', () => {
                    document.getElementById('banner-form-card').style.display = 'none';
                });
            }
            
            // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞
            document.querySelectorAll('.edit-banner').forEach(btn => {
                btn.addEventListener('click', () => editBanner(btn.dataset.id));
            });
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞
            document.querySelectorAll('.delete-banner').forEach(btn => {
                btn.addEventListener('click', () => deleteBanner(btn.dataset.id));
            });
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞
            const bannerForm = document.getElementById('banner-form');
            if (bannerForm) {
                bannerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await saveBanner();
                });
            }
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞ –∏–∑ —Ñ–æ—Ä–º—ã
            const deleteBannerBtn = document.getElementById('delete-banner-btn');
            if (deleteBannerBtn) {
                deleteBannerBtn.addEventListener('click', async () => {
                    const bannerId = document.getElementById('banner-id').value;
                    if (bannerId && confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –±–∞–Ω–Ω–µ—Ä?')) {
                        await deleteBanner(bannerId);
                    }
                });
            }
        }
        
        function resetBannerForm() {
            document.getElementById('banner-id').value = '';
            document.getElementById('banner-name').value = '';
            document.getElementById('banner-description').value = '';
            document.getElementById('banner-image-url').value = '';
            document.getElementById('banner-preview-url').value = '';
            document.getElementById('banner-price').value = '0';
            document.getElementById('banner-rarity').value = 'common';
            document.getElementById('banner-category').value = '';
            document.getElementById('banner-tags').value = '';
            document.getElementById('banner-active').checked = true;
            document.getElementById('banner-featured').checked = false;
            document.getElementById('delete-banner-btn').style.display = 'none';
        }
        
        async function editBanner(bannerId) {
            try {
                showLoading();
                const response = await fetch(`/api/admin/banners/${bannerId}`);
                const banner = await response.json();
                
                if (response.ok) {
                    document.getElementById('banner-form-title').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–Ω–Ω–µ—Ä–∞';
                    document.getElementById('banner-form-card').style.display = 'block';
                    
                    document.getElementById('banner-id').value = banner.id;
                    document.getElementById('banner-name').value = banner.name;
                    document.getElementById('banner-description').value = banner.description || '';
                    document.getElementById('banner-image-url').value = banner.image_url;
                    document.getElementById('banner-preview-url').value = banner.preview_url || '';
                    document.getElementById('banner-price').value = banner.price;
                    document.getElementById('banner-rarity').value = banner.rarity;
                    document.getElementById('banner-category').value = banner.category || '';
                    document.getElementById('banner-tags').value = banner.tags ? banner.tags.join(', ') : '';
                    document.getElementById('banner-active').checked = banner.is_active;
                    document.getElementById('banner-featured').checked = banner.is_featured || false;
                    document.getElementById('delete-banner-btn').style.display = 'block';
                }
            } catch (error) {
                console.error('Error loading banner:', error);
                showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–Ω–Ω–µ—Ä–∞', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function saveBanner() {
            const bannerId = document.getElementById('banner-id').value;
            const bannerData = {
                name: document.getElementById('banner-name').value,
                description: document.getElementById('banner-description').value,
                image_url: document.getElementById('banner-image-url').value,
                preview_url: document.getElementById('banner-preview-url').value || document.getElementById('banner-image-url').value,
                price: parseInt(document.getElementById('banner-price').value),
                rarity: document.getElementById('banner-rarity').value,
                category: document.getElementById('banner-category').value,
                tags: document.getElementById('banner-tags').value ? document.getElementById('banner-tags').value.split(',').map(tag => tag.trim()) : [],
                is_active: document.getElementById('banner-active').checked,
                is_featured: document.getElementById('banner-featured').checked
            };
            
            try {
                showLoading();
                const url = bannerId ? `/api/admin/banners/${bannerId}` : '/api/admin/banners';
                const method = bannerId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(bannerData)
                });
                
                if (response.ok) {
                    showMessage(bannerId ? '–ë–∞–Ω–Ω–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω' : '–ë–∞–Ω–Ω–µ—Ä —Å–æ–∑–¥–∞–Ω');
                    loadBanners();
                    document.getElementById('banner-form-card').style.display = 'none';
                } else {
                    const error = await response.json();
                    showMessage(error.error || '–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error saving banner:', error);
                showMessage('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function deleteBanner(bannerId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –±–∞–Ω–Ω–µ—Ä?')) {
                return;
            }
            
            try {
                showLoading();
                const response = await fetch(`/api/admin/banners/${bannerId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showMessage('–ë–∞–Ω–Ω–µ—Ä —É–¥–∞–ª–µ–Ω');
                    loadBanners();
                    document.getElementById('banner-form-card').style.display = 'none';
                } else {
                    const error = await response.json();
                    showMessage(error.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error deleting banner:', error);
                showMessage('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        // === TELEGRAM –ë–û–¢ ===
        async function loadBotStatus() {
            try {
                const response = await fetch('/api/admin/bot/status');
                const status = await response.json();
                
                if (response.ok) {
                    document.getElementById('bot-status').textContent = status.running ? '‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç' : '‚ùå –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω';
                    document.getElementById('bot-details').textContent = status.token_set ? '–¢–æ–∫–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω' : '–¢–æ–∫–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
                    
                    document.getElementById('bot-token').value = status.token_set ? '********' : '–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω';
                    document.getElementById('server-url').value = status.server_url || 'http://localhost:5001';
                    document.getElementById('bot-auto-start').value = status.auto_start.toString();
                    
                    // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–æ—Ç–∞
                    await loadBotStats();
                }
            } catch (error) {
                console.error('Error loading bot status:', error);
            }
        }
        
        async function loadBotStats() {
            try {
                const response = await fetch('/api/admin/bot/stats');
                const stats = await response.json();
                
                if (response.ok) {
                    document.getElementById('bot-users').textContent = stats.telegram_users || 0;
                    document.getElementById('active-codes').textContent = stats.active_codes || 0;
                    document.getElementById('notifications-sent').textContent = stats.notifications_today || 0;
                }
            } catch (error) {
                console.error('Error loading bot stats:', error);
            }
        }
        
        function addBotEventListeners() {
            // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
            const restartBtn = document.getElementById('restart-bot-btn');
            if (restartBtn) {
                restartBtn.addEventListener('click', async () => {
                    if (confirm('–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Telegram –±–æ—Ç–∞?')) {
                        try {
                            showLoading();
                            const response = await fetch('/api/admin/bot/restart', {
                                method: 'POST'
                            });
                            
                            const result = await response.json();
                            if (result.success) {
                                showMessage('–ë–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω');
                                setTimeout(() => loadBotStatus(), 2000);
                            } else {
                                showMessage(result.message || '–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞', 'error');
                            }
                        } catch (error) {
                            console.error('Error restarting bot:', error);
                            showMessage('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞', 'error');
                        } finally {
                            hideLoading();
                        }
                    }
                });
            }
            
            // –¢–µ—Å—Ç –±–æ—Ç–∞
            const testBtn = document.getElementById('test-bot-btn');
            if (testBtn) {
                testBtn.addEventListener('click', async () => {
                    const telegramId = prompt('–í–≤–µ–¥–∏—Ç–µ Telegram ID –¥–ª—è —Ç–µ—Å—Ç–∞:');
                    if (telegramId) {
                        const message = '‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ itired';
                        await sendTestMessage(telegramId, message);
                    }
                });
            }
            
            // –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
            const testForm = document.getElementById('test-message-form');
            if (testForm) {
                testForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const telegramId = document.getElementById('test-telegram-id').value;
                    const message = document.getElementById('test-message').value;
                    await sendTestMessage(telegramId, message);
                });
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            const serverUrlInput = document.getElementById('server-url');
            if (serverUrlInput) {
                serverUrlInput.addEventListener('change', async () => {
                    await updateBotSettings();
                });
            }
            
            const autoStartSelect = document.getElementById('bot-auto-start');
            if (autoStartSelect) {
                autoStartSelect.addEventListener('change', async () => {
                    await updateBotSettings();
                });
            }
        }
        
        async function sendTestMessage(telegramId, message) {
            try {
                showLoading();
                const response = await fetch('/api/admin/bot/test_message', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        telegram_id: telegramId,
                        message: message
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    showMessage('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ');
                } else {
                    showMessage(result.message || '–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏', 'error');
                }
            } catch (error) {
                console.error('Error sending test message:', error);
                showMessage('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function updateBotSettings() {
            try {
                const settings = {
                    server_url: document.getElementById('server-url').value,
                    auto_start: document.getElementById('bot-auto-start').value === 'true'
                };
                
                const response = await fetch('/api/admin/bot/settings', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(settings)
                });
                
                if (response.ok) {
                    showMessage('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
                }
            } catch (error) {
                console.error('Error updating bot settings:', error);
            }
        }
        
        // === –ó–ê–ì–†–£–ó–ö–ê –§–ê–ô–õ–û–í ===
        function addUploadEventListeners() {
            const uploadArea = document.getElementById('upload-area');
            const fileInput = document.getElementById('file-input');
            const uploadBtn = document.getElementById('upload-btn');
            
            // –ö–ª–∏–∫ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏
            uploadArea.addEventListener('click', () => {
                fileInput.click();
            });
            
            // Drag & drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--accent-primary)';
                uploadArea.style.background = 'var(--bg-hover)';
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.style.borderColor = 'var(--border-color)';
                uploadArea.style.background = '';
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--border-color)';
                uploadArea.style.background = '';
                
                if (e.dataTransfer.files.length > 0) {
                    handleFileSelect(e.dataTransfer.files[0]);
                }
            });
            
            // –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ input
            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleFileSelect(e.target.files[0]);
                }
            });
            
            // –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
            uploadBtn.addEventListener('click', async () => {
                if (!selectedFile) {
                    showMessage('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
                    return;
                }
                
                await uploadFile();
            });
        }
        
        function handleFileSelect(file) {
            selectedFile = file;
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (16MB)
            if (file.size > 16 * 1024 * 1024) {
                showMessage('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å. 16MB)', 'error');
                selectedFile = null;
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞
            const ext = file.name.split('.').pop().toLowerCase();
            const allowedExts = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'svg', 'mp3', 'wav', 'ogg', 'mp4'];
            
            if (!allowedExts.includes(ext)) {
                showMessage('–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞', 'error');
                selectedFile = null;
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('upload-filename').value = file.name;
            document.getElementById('upload-btn').disabled = false;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–µ
            const fileSize = (file.size / 1024 / 1024).toFixed(2);
            showMessage(`–í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª: ${file.name} (${fileSize} MB)`, 'success');
        }
        
        async function uploadFile() {
            if (!selectedFile) return;
            
            const formData = new FormData();
            formData.append('file', selectedFile);
            formData.append('type', document.getElementById('upload-type').value);
            formData.append('filename', document.getElementById('upload-filename').value || selectedFile.name);
            
            try {
                showLoading();
                const progressBar = document.querySelector('.progress-bar');
                const progressContainer = document.getElementById('upload-progress');
                
                progressContainer.style.display = 'block';
                progressBar.style.width = '0%';
                
                const xhr = new XMLHttpRequest();
                xhr.open('POST', '/api/admin/upload');
                xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
                
                xhr.upload.onprogress = (e) => {
                    if (e.lengthComputable) {
                        const percentComplete = (e.loaded / e.total) * 100;
                        progressBar.style.width = percentComplete + '%';
                    }
                };
                
                xhr.onload = () => {
                    if (xhr.status === 200) {
                        const result = JSON.parse(xhr.response);
                        if (result.success) {
                            showMessage('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω: ' + result.url);
                            loadUploadedFiles();
                            resetUploadForm();
                        } else {
                            showMessage(result.message || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
                        }
                    } else {
                        showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞', 'error');
                    }
                    progressContainer.style.display = 'none';
                    hideLoading();
                };
                
                xhr.onerror = () => {
                    showMessage('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞', 'error');
                    progressContainer.style.display = 'none';
                    hideLoading();
                };
                
                xhr.send(formData);
            } catch (error) {
                console.error('Error uploading file:', error);
                showMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞', 'error');
                hideLoading();
            }
        }
        
        function resetUploadForm() {
            selectedFile = null;
            document.getElementById('file-input').value = '';
            document.getElementById('upload-filename').value = '';
            document.getElementById('upload-btn').disabled = true;
            document.getElementById('upload-progress').style.display = 'none';
        }
        
        async function loadUploadedFiles() {
            try {
                const response = await fetch('/api/admin/uploads');
                const files = await response.json();
                
                if (response.ok) {
                    const tbody = document.getElementById('uploaded-files-body');
                    tbody.innerHTML = '';
                    
                    files.forEach(file => {
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${file.name}</td>
                            <td>${file.type}</td>
                            <td>${(file.size / 1024).toFixed(2)} KB</td>
                            <td><a href="${file.url}" target="_blank">${file.url}</a></td>
                            <td>${new Date(file.uploaded_at).toLocaleString()}</td>
                            <td>
                                <button class="btn btn-sm btn-danger delete-file" data-url="${file.url}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                    
                    addFileDeleteListeners();
                }
            } catch (error) {
                console.error('Error loading uploaded files:', error);
            }
        }
        
        function addFileDeleteListeners() {
            document.querySelectorAll('.delete-file').forEach(btn => {
                btn.addEventListener('click', async () => {
                    const url = btn.dataset.url;
                    if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ñ–∞–π–ª?')) {
                        await deleteFile(url);
                    }
                });
            });
        }
        
        async function deleteFile(url) {
            try {
                showLoading();
                const response = await fetch(`/api/admin/uploads?url=${encodeURIComponent(url)}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showMessage('–§–∞–π–ª —É–¥–∞–ª–µ–Ω');
                    loadUploadedFiles();
                } else {
                    const error = await response.json();
                    showMessage(error.error || '–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
                }
            } catch (error) {
                console.error('Error deleting file:', error);
                showMessage('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è', 'error');
            } finally {
                hideLoading();
            }
        }
        
        // === –°–ò–°–¢–ï–ú–ê ===
        async function loadSystemInfo() {
            try {
                const response = await fetch('/health');
                const health = await response.json();
                
                if (response.ok) {
                    document.getElementById('db-status').textContent = health.database === 'connected' ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ–ª–∞–π–Ω';
                    document.getElementById('redis-status').textContent = health.redis === 'connected' ? '–û–Ω–ª–∞–π–Ω' : '–û—Ñ–ª–∞–π–Ω';
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    await loadSystemStats();
                    await loadSystemLogs();
                }
            } catch (error) {
                console.error('Error loading system info:', error);
            }
        }
        
        async function loadSystemStats() {
            try {
                const response = await fetch('/api/admin/system/stats');
                const stats = await response.json();
                
                if (response.ok) {
                    document.getElementById('memory-usage').textContent = stats.memory_usage + '%';
                    document.getElementById('uptime').textContent = stats.uptime;
                }
            } catch (error) {
                console.error('Error loading system stats:', error);
            }
        }
        
        async function loadSystemLogs() {
            try {
                const response = await fetch('/api/admin/system/logs');
                const logs = await response.json();
                
                if (response.ok) {
                    const logTextarea = document.getElementById('system-logs');
                    logTextarea.value = logs.join('\n');
                    logTextarea.scrollTop = logTextarea.scrollHeight;
                }
            } catch (error) {
                console.error('Error loading system logs:', error);
            }
        }
        
        function addSystemEventListeners() {
            // –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
            const clearCacheBtn = document.getElementById('clear-cache-btn');
            if (clearCacheBtn) {
                clearCacheBtn.addEventListener('click', async () => {
                    if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à —Å–∏—Å—Ç–µ–º—ã?')) {
                        await clearCache();
                    }
                });
            }
            
            // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–¥–æ–≤
            const clearCodesBtn = document.getElementById('clear-old-codes-btn');
            if (clearCodesBtn) {
                clearCodesBtn.addEventListener('click', async () => {
                    if (confirm('–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∫–æ–¥—ã Telegram?')) {
                        await clearOldCodes();
                    }
                });
            }
            
            // –°–±—Ä–æ—Å –º–∞–≥–∞–∑–∏–Ω–∞
            const resetShopBtn = document.getElementById('reset-shop-btn');
            if (resetShopBtn) {
                resetShopBtn.addEventListener('click', async () => {
                    if (confirm('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã.')) {
                        await resetShop();
                    }
                });
            }
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤
            const refreshLogsBtn = document.getElementById('refresh-logs-btn');
            if (refreshLogsBtn) {
                refreshLogsBtn.addEventListener('click', async () => {
                    await loadSystemLogs();
                });
            }
            
            // –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤
            const clearLogsBtn = document.getElementById('clear-logs-btn');
            if (clearLogsBtn) {
                clearLogsBtn.addEventListener('click', async () => {
                    if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã?')) {
                        await clearLogs();
                    }
                });
            }
        }
        
        async function clearCache() {
            try {
                showLoading();
                const response = await fetch('/api/admin/system/clear_cache', {
                    method: 'POST'
                });
                
                const result = await response.json();
                if (result.success) {
                    showMessage('–ö—ç—à –æ—á–∏—â–µ–Ω');
                } else {
                    showMessage(result.message || '–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞', 'error');
                }
            } catch (error) {
                console.error('Error clearing cache:', error);
                showMessage('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function clearOldCodes() {
            try {
                showLoading();
                const response = await fetch('/api/admin/system/clear_old_codes', {
                    method: 'POST'
                });
                
                const result = await response.json();
                if (result.success) {
                    showMessage(`–£–¥–∞–ª–µ–Ω–æ ${result.deleted} –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤`);
                } else {
                    showMessage(result.message || '–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫–æ–¥–æ–≤', 'error');
                }
            } catch (error) {
                console.error('Error clearing old codes:', error);
                showMessage('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –∫–æ–¥–æ–≤', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function resetShop() {
            try {
                showLoading();
                const response = await fetch('/api/admin/system/reset_shop', {
                    method: 'POST'
                });
                
                const result = await response.json();
                if (result.success) {
                    showMessage('–ú–∞–≥–∞–∑–∏–Ω —Å–±—Ä–æ—à–µ–Ω –¥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π');
                    loadShopItems();
                } else {
                    showMessage(result.message || '–û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –º–∞–≥–∞–∑–∏–Ω–∞', 'error');
                }
            } catch (error) {
                console.error('Error resetting shop:', error);
                showMessage('–û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –º–∞–≥–∞–∑–∏–Ω–∞', 'error');
            } finally {
                hideLoading();
            }
        }
        
        async function clearLogs() {
            try {
                showLoading();
                const response = await fetch('/api/admin/system/clear_logs', {
                    method: 'POST'
                });
                
                const result = await response.json();
                if (result.success) {
                    showMessage('–õ–æ–≥–∏ –æ—á–∏—â–µ–Ω—ã');
                    document.getElementById('system-logs').value = '';
                } else {
                    showMessage(result.message || '–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤', 'error');
                }
            } catch (error) {
                console.error('Error clearing logs:', error);
                showMessage('–û—à–∏–±–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ª–æ–≥–æ–≤', 'error');
            } finally {
                hideLoading();
            }
        }
        
        // === –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ===
        function getRarityClass(rarity) {
            switch(rarity.toLowerCase()) {
                case 'common': return 'badge-info';
                case 'rare': return 'badge-success';
                case 'epic': return 'badge-warning';
                case 'legendary': return 'badge-danger';
                case 'mythic': return 'badge-danger';
                default: return 'badge-info';
            }
        }
        
        function updatePagination(elementId, totalPages, currentPage) {
            const pagination = document.getElementById(elementId);
            if (!pagination) return;
            
            pagination.innerHTML = '';
            
            // –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥"
            if (currentPage > 1) {
                const prevLink = document.createElement('a');
                prevLink.href = '#';
                prevLink.className = 'page-link';
                prevLink.innerHTML = '<i class="fas fa-chevron-left"></i>';
                prevLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    loadUsers(currentPage - 1);
                });
                pagination.appendChild(prevLink);
            }
            
            // –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    const pageLink = document.createElement('a');
                    pageLink.href = '#';
                    pageLink.className = `page-link ${i === currentPage ? 'active' : ''}`;
                    pageLink.textContent = i;
                    pageLink.addEventListener('click', (e) => {
                        e.preventDefault();
                        if (i !== currentPage) {
                            loadUsers(i);
                        }
                    });
                    pagination.appendChild(pageLink);
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'page-link';
                    ellipsis.textContent = '...';
                    pagination.appendChild(ellipsis);
                }
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–í–ø–µ—Ä–µ–¥"
            if (currentPage < totalPages) {
                const nextLink = document.createElement('a');
                nextLink.href = '#';
                nextLink.className = 'page-link';
                nextLink.innerHTML = '<i class="fas fa-chevron-right"></i>';
                nextLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    loadUsers(currentPage + 1);
                });
                pagination.appendChild(nextLink);
            }
        }
        
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
        document.addEventListener('DOMContentLoaded', async () => {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ–∫—Ü–∏–∏
            await loadSectionData(currentSection);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤—Å–µ—Ö —Å–µ–∫—Ü–∏–π
            addUserEventListeners();
            addShopEventListeners();
            addBannerEventListeners();
            addBotEventListeners();
            addUploadEventListeners();
            addSystemEventListeners();
            
            // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            setInterval(() => {
                if (currentSection === 'stats') {
                    loadStats();
                } else if (currentSection === 'bot') {
                    loadBotStatus();
                }
            }, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
        });
    </script>
</body>
</html>